# 数据链路
- 链路是一个结点到相邻结点的一段物理线路，且中间没有任何其他交换结点
- 数据链路是指把实现通信协议的软硬件加到链路上
- 以帧为单位传输和处理数据

# 点对点中三个重要问题
## 封装成帧
- 将网络层传递的数据添加帧头（目的地址、源地址）和帧尾（FCS检测码）
- 作用之一为帧定界，在物理层传输中可提取出帧；但也不是所有数据链路层的帧都有该作用（如以太网MAC版本2），物理层会添加前导码（前同步码、帧开始定界符），还规定了每个帧之间间隔为96比特
  - 在发送帧之前，会对帧进行扫描，数据中如果出现了帧定界符或者转义符则需要转义

# 媒体接入控制

## 静态划分信道
1. 频分复用
  - 将传输线路的频带资源划分成多个子频带，每个子频带，形成多个子信道，各个子信道之间需要留出隔离频带，避免子信道之间相互干扰
2. 时分复用
  - 将时间划分成时隙，每个时隙提供一个用户使用
3. 波分复用
4. 码分复用
  - 每个站点都被指派唯一的码片序列，各个站点的码片序列必须相互正交（规格化内积为0）

## 动态划分信道--随机接入
- 多个站点连接在一条总线上，竞争使用
- 每个站点发送帧之前需要检测总线上是否有其他站点发送帧
- 每一个正在发送帧的站需要边发送边检测
- 以太网规定最小帧长为64字节，如果发送数据太少则必须加入填充字节（防止数据太少发生碰撞的时候，发送站点已经停止检测了）

### 争用期
- 站点最多经过两倍传播时延（争用期）就可检测到是否遭受了碰撞
- 如果以太网中发送帧的主机越多，那么传播时延越大，发送碰撞概率越大。因此，共享以太网不能连接过多主机，使用总线也不能过长
  - 10Mb/s以太网将争用期定为512bit，因此总线长度不超5120m

### 最小帧长
- 由于站点针对已发送完毕的数据不再检测，如果数据大小过小，并且在传输过程中遭遇碰撞，那么无法检测到
- 故以太网规定最小帧长为64字节

# MAC地址
- MAC地址一般固化在网卡的电可擦可编程只读存储器EEPROM中

# 虚拟局域网VLAN

## 产生原因和作用
- 想要分割广播域，考虑使用路由器，但是路由器成本较高，局域网内部全部使用路由器来隔离广播域是不现实的，于是产生了虚拟局域网
- 虚拟局域网是一种将局域网内的设备划分成与物理位置无关的逻辑组技术，实现在交换机中

## 实现机制
1. 对帧格式进行扩展，插入VLAN标记
2. 交换机收到普通以太网帧，对其插入VLAN标记
  - 交换机Access端口和Trunk端口接收未打标签的广播帧，根据端口的PVID给帧“打标签”，即帧中VLAN的VID取值和端口的PVID一致
3. 交换机转发带有VLAN标记的帧时，可能会删除该标记
  - Access端口对于帧中的VID和端口的PVID相等的广播帧，进行去除标签并转发，如果不相等则不转发
  - Trunk端口对于VID等于当前端口PVID的广播帧，执行去标签再转发，如果不相等则直接转发